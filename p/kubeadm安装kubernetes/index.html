<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kubeadm安装Kubernetes"><title>Kubeadm安装Kubernetes</title><link rel=canonical href=https://fengzhenbing.github.io/p/kubeadm%E5%AE%89%E8%A3%85kubernetes/><link rel=stylesheet href=/scss/style.min.css><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta property="og:title" content="Kubeadm安装Kubernetes"><meta property="og:description" content="Kubeadm安装Kubernetes"><meta property="og:url" content="https://fengzhenbing.github.io/p/kubeadm%E5%AE%89%E8%A3%85kubernetes/"><meta property="og:site_name" content="Feng Zhenbing's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="微服务"><meta property="article:tag" content="云原生"><meta property="article:tag" content="K8S"><meta property="article:published_time" content="2021-06-08T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-08T00:00:00+00:00"><meta name=twitter:title content="Kubeadm安装Kubernetes"><meta name=twitter:description content="Kubeadm安装Kubernetes"></head><body class="article-page has-toc"><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script><div class="container main-container flex
extended"><div id=article-toolbar><a href=https://fengzhenbing.github.io/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>返回</span></a></div><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/>云原生</a>
<a href=/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/>微服务</a>
<a href=/categories/k8s/>K8S</a></header><h2 class=article-title><a href=/p/kubeadm%E5%AE%89%E8%A3%85kubernetes/>Kubeadm安装Kubernetes</a></h2><h3 class=article-subtitle>Kubeadm安装Kubernetes</h3><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jun 08, 2021</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 3 分钟</time></div><div><svg t="1631787077345" class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="2237" width="48" height="48" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M512 608a96 96 0 110-192 96 96 0 010 192m0-256c-88.224.0-160 71.776-160 160s71.776 160 160 160 160-71.776 160-160-71.776-160-160-160" p-id="2238" fill="#bfbfbf"/><path d="M512 8e2c-212.064.0-384-256-384-288s171.936-288 384-288 384 256 384 288-171.936 288-384 288m0-640C265.248 160 64 443.008 64 512s201.248 352 448 352 448-283.008 448-352S758.752 160 512 160" p-id="2239" fill="#bfbfbf"/></svg><time class=article-time--reading>总阅读量:<span id=busuanzi_value_page_pv></span>次</time></div></footer></div></header><section class=article-content><h2 id=1环境准备>1.环境准备</h2><p>安装 Kubernetes 最小需要 2 核处理器、2 GB 内存，且为 x86 架构（暂不支持 ARM 架构)</p><p>本次实验操作系统：ubantu 20.04LTS</p><p>Kubernetes 并不在主流 Debian 系统自带的软件源中，所以要手工注册，然后才能使用<code>apt-get</code>安装</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># 添加GPG Key</span>
$ sudo curl -fsSL https://packages.cloud.google.com/apt/doc/apt-key.gpg <span class=p>|</span> sudo apt-key add -

<span class=c1># 添加K8S软件源</span>
$ sudo add-apt-repository <span class=s2>&#34;deb https://apt.kubernetes.io/ kubernetes-xenial main&#34;</span>
</code></pre></div><p>如果不能科学上网，可以使用阿里云的软件源地址</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># 添加GPG Key</span>
$ curl -fsSL http://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg <span class=p>|</span> sudo apt-key add -

<span class=c1># 添加K8S软件源</span>
$ sudo add-apt-repository <span class=s2>&#34;deb http://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial main&#34;</span>
</code></pre></div><p>添加源后需要更新</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo apt-get update
</code></pre></div><h2 id=2-安装-kubeletkubectlkubeadm>2. 安装 <strong>kubelet</strong>、<strong>kubectl</strong>、<strong>kubeadm</strong></h2><p>官网介绍：https://kubernetes.io/docs/reference/setup-tools/kubeadm/</p><ul><li>kubeadm: 引导启动 Kubernate 集群的命令行工具。</li><li>kubelet: 在群集中的所有计算机上运行的组件, 并用来执行如启动 Pods 和 Containers 等操作。</li><li>kubectl: 用于操作运行中的集群的命令行工具。</li></ul><h3 id=21关闭swap-分区>2.1关闭Swap 分区</h3><p>kubeadm 初始化集群之前，需要关闭Swap 分区，首先基于安全性（如在官方文档中承诺的 Secret 只会在内存中读写，不会落盘）、利于保证节点同步一致性等原因，从 1.8 版开始，Kubernetes 就在它的文档中明确声明了它默认<strong>不支持</strong>Swap 分区，在未关闭 Swap 分区的机器中，集群将直接无法启动；</p><p>其他参考</p><blockquote><p>主要有两个方面原因：</p><p>第一是因为性能问题，在生产环境我们经常会遇到容器性能突然降低的情况，查看原因后，大部分都是因为开启了swap导致的。swap看似解决了有限内存的问题，但这种通过时间换空间的做法也给性能带来了很大问题，尤其是在高并发场景中，很容易导致系统不稳定。</p><p>第二是因为k8s定义的资源模型中，CPU和内存都是确定的可用资源，在调度的时候都会考虑在内。比如，设置了内存设置了limit 2G，就代表最大可用内存是2G，而引入swap（cgroup支持swap限制）后这个模型就变得复杂了，而且需要结合Qos，swap的使用完全是由操作系统根据水位自行调节的，并不直接受kubelet管理</p></blockquote><p>一次性关闭</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo swapoff -a
</code></pre></div><p>永久关闭</p><p>编辑器打开<code>/etc/fstab</code>，注释其中带有“swap”的行即可，</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># 先备份</span>
$ yes <span class=p>|</span> sudo cp /etc/fstab /etc/fstab_bak
<span class=c1># 进行修改</span>
$ sudo cat /etc/fstab_bak <span class=p>|</span> grep -v swap &gt; /etc/fstab
</code></pre></div><h2 id=3-预拉取镜像>3 预拉取镜像</h2><p>先查看kubeadm版本 v1.21.3</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>root@fengzhenbing-ubuntu:/home/fengzhenbing# kubeadm version
kubeadm version: <span class=p>&amp;</span>version.Info<span class=o>{</span>Major:<span class=s2>&#34;1&#34;</span>, Minor:<span class=s2>&#34;21&#34;</span>, GitVersion:<span class=s2>&#34;v1.21.3&#34;</span>, GitCommit:<span class=s2>&#34;ca643a4d1f7bfe34773c74f79527be4afd95bf39&#34;</span>, GitTreeState:<span class=s2>&#34;clean&#34;</span>, BuildDate:<span class=s2>&#34;2021-07-15T21:03:28Z&#34;</span>, GoVersion:<span class=s2>&#34;go1.16.6&#34;</span>, Compiler:<span class=s2>&#34;gc&#34;</span>, Platform:<span class=s2>&#34;linux/amd64&#34;</span><span class=o>}</span>
</code></pre></div><p>首先使用以下命令查询当前版本需要哪些镜像：</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>fengzhenbing@fengzhenbing-ubuntu:/etc/docker$ kubeadm config images list --kubernetes-version v1.21.3
k8s.gcr.io/kube-apiserver:v1.21.3
k8s.gcr.io/kube-controller-manager:v1.21.3
k8s.gcr.io/kube-scheduler:v1.21.3
k8s.gcr.io/kube-proxy:v1.21.3
k8s.gcr.io/pause:3.4.1
k8s.gcr.io/etcd:3.4.13-0
k8s.gcr.io/coredns/coredns:v1.8.0
</code></pre></div><p>k8s.gcr.io 为google官方（Google Container Registry），对于不能科学上网的同学来说，可以使用阿里云加速</p><h3 id=31-配置阿里云加速地址>3.1 配置阿里云加速地址</h3><p>阿里云加速地址获取 <a href=https://cr.console.aliyun.com/cn-shanghai/instances/mirrors>https://cr.console.aliyun.com/cn-shanghai/instances/mirrors</a></p><p><img src=https://gitee.com/fengzhenbing/picgo/raw/master/image-20210725221057446.png alt=image-20210725221057446></p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo tee /etc/docker/daemon.json <span class=s>&lt;&lt;-&#39;EOF&#39;
</span><span class=s>{
</span><span class=s>  &#34;registry-mirrors&#34;: [&#34;https://xxxx.mirror.aliyuncs.com&#34;]
</span><span class=s>}
</span><span class=s>EOF</span>
sudo systemctl daemon-reload
sudo systemctl restart docker
</code></pre></div><h3 id=32-拉取镜像修改tag>3.2 拉取镜像，修改tag</h3><p>对于通过<code>kubeadm config images list --kubernetes-version v1.21.3</code>查找到需要下载的镜像名称及版本后，可以从<a class=link href=https://hub.docker.com/ target=_blank rel=noopener>DockerHub</a>上找存有相同镜像的仓库来拉取。 我是用的<a class=link href=https://hub.docker.com/r/k8simage/kube-proxy target=_blank rel=noopener>k8simage</a>的仓库，找到对应的v1.21.3版本的对应image</p><p>下面为从k8simage拉取到的镜像</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>fengzhenbing@fengzhenbing-ubuntu:/etc/docker$  sudo docker image list
REPOSITORY                         TAG        IMAGE ID       CREATED         SIZE
k8simage/kube-apiserver            v1.21.3    3d174f00aa39   <span class=m>9</span> days ago      126MB
k8simage/kube-scheduler            v1.21.3    6be0dc1302e3   <span class=m>9</span> days ago      50.6MB
k8simage/kube-controller-manager   v1.21.3    bc2bb319a703   <span class=m>9</span> days ago      120MB
k8simage/kube-proxy                v1.21.3    adb2816ea823   <span class=m>9</span> days ago      103MB
k8simage/pause                     3.4.1      0f8457a4c2ec   <span class=m>6</span> months ago    683kB
k8simage/etcd                      3.4.13-0   0369cf4303ff   <span class=m>11</span> months ago   253MB
k8simage/coredns                   1.7.0      bfe3a36ebd25   <span class=m>13</span> months ago   45.2MB
</code></pre></div><p>对每一镜像，1先拉取，2修改tag 3最后删除原来的。以kube-apiserver v1.21.3为例子</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo docker pull k8simage/kube-apiserver:v1.21.3
sudo docker tag k8simage/kube-apiserver:v1.21.3 k8s.gcr.io/kube-apiserver:v1.21.3
sudo docker rmi k8simage/kube-apiserver:v1.21.3
</code></pre></div><p>上面全部操作结束后 可看到都更新为<code>kubeadm config images list --kubernetes-version v1.21.3</code>所需要的镜像了</p><pre><code>root@fengzhenbing-ubuntu:/home/fengzhenbing# sudo docker image list
REPOSITORY                           TAG        IMAGE ID       CREATED         SIZE
k8s.gcr.io/kube-apiserver            v1.21.3    3d174f00aa39   9 days ago      126MB
k8s.gcr.io/kube-scheduler            v1.21.3    6be0dc1302e3   9 days ago      50.6MB
k8s.gcr.io/kube-proxy                v1.21.3    adb2816ea823   9 days ago      103MB
k8s.gcr.io/kube-controller-manager   v1.21.3    bc2bb319a703   9 days ago      120MB
quay.io/coreos/flannel               v0.14.0    8522d622299c   2 months ago    67.9MB
k8s.gcr.io/pause                     3.4.1      0f8457a4c2ec   6 months ago    683kB
k8s.gcr.io/etcd                      3.4.13-0   0369cf4303ff   11 months ago   253MB
k8s.gcr.io/coredns/coredns           v1.8.0     bfe3a36ebd25   13 months ago   45.2MB
</code></pre><h2 id=4-初始化集群控制平面>4 初始化集群控制平面</h2><ul><li>确保 kubelet 是开机启动的</li></ul><pre><code>fengzhenbing@fengzhenbing-ubuntu:/etc/docker$ sudo systemctl start kubelet
fengzhenbing@fengzhenbing-ubuntu:/etc/docker$ sudo systemctl enable kubelet
</code></pre><ul><li>su 直接切换到 root 用户， 保证是root启动部署</li></ul><pre><code>kubeadm init \
  --pod-network-cidr=10.244.0.0/16 \
  --kubernetes-version v1.21.3 \
  --control-plane-endpoint 192.168.3.13
</code></pre><ul><li>参数介绍</li></ul><blockquote><p><code>--kubernetes-version</code>参数（要注意版本号与 kubelet 一致）的目的是与前面预拉取是一样的，避免额外的网络访问去查询版本号；如果能够科学上网，不需要加这个参数。</p><p><code>--pod-network-cidr</code>参数是给Flannel网络做网段划分使用的，着在稍后介绍完 CNI 网络插件时会去说明。</p><p><code>--control-plane-endpoint</code>参数是控制面的地址，强烈建议使用一个域名代替直接的IP地址来建立Kubernetes集群。因为CA证书直接与地址相关，Kubernetes中诸多配置（配置文件、ConfigMap资源）也直接存储了这个地址，一旦更换IP，要想要不重置集群，手工换起来异常麻烦。所以最好使用hostname（仅限单节点实验）或者dns name。</p></blockquote><p>执行完，如下提示表明成功</p><p><img src=https://gitee.com/fengzhenbing/picgo/raw/master/image-20210725225837358.png alt=image-20210725225837358></p><h2 id=5-为当前用户生成-kubeconfig>5 为当前用户生成 <strong>kubeconfig</strong></h2><p>使用 Kubernetes 前需要为当前用户先配置好 admin.conf 文件</p><pre><code>root@fengzhenbing-ubuntu:~# mkdir -p $HOME/.kube
root@fengzhenbing-ubuntu:~# sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
root@fengzhenbing-ubuntu:~# sudo chown $(id -u):$(id -g) $HOME/.kube/config
</code></pre><h2 id=6-cni插件>6 CNI插件</h2><p>CNI 即“容器网络接口”</p><p>部署 Kubernetes 时，我们可以有两种网络方案使得以后受管理的容器之间进行网络通讯：</p><ul><li>使用 Kubernetes 的默认网络： 操作太复杂</li><li>使用 CNI 及其插件：</li></ul><p>Flannel 插件为比较推荐的</p><h3 id=安装flannel-插件>安装Flannel 插件</h3><pre><code>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
</code></pre><p><a href=https://raw.githubusercontent.com>https://raw.githubusercontent.com</a> 无法访问时，可以找到该yml文件上传到服务器，如下执行</p><pre><code>root@fengzhenbing-ubuntu:/home/fengzhenbing# kubectl apply -f kube-flannel.yml 
Warning: policy/v1beta1 PodSecurityPolicy is deprecated in v1.21+, unavailable in v1.25+
podsecuritypolicy.policy/psp.flannel.unprivileged created
clusterrole.rbac.authorization.k8s.io/flannel created
clusterrolebinding.rbac.authorization.k8s.io/flannel created
serviceaccount/flannel created
configmap/kube-flannel-cfg created
daemonset.apps/kube-flannel-ds created
</code></pre><pre><code>$ kubectl taint nodes --all node-role.kubernetes.io/master-
</code></pre><h2 id=7-kubectl-命令自动补全功能>7 <strong>kubectl</strong> 命令自动补全功能</h2><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>$ <span class=nb>echo</span> <span class=s1>&#39;source &lt;(kubectl completion bash)&#39;</span> &gt;&gt; ~/.bashrc
$ <span class=nb>echo</span> <span class=s1>&#39;source /usr/share/bash-completion/bash_completion&#39;</span> &gt;&gt; ~/.bashrc
</code></pre></div><h2 id=8-加入其他-node-节点到-kubernetes-集群中>8 加入其他 <strong>Node</strong> 节点到 <strong>Kubernetes</strong> 集群中</h2><p>kubeadm init执行成功后的反馈内容中有提到：如上面的截图</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>You can now join any number of control-plane nodes by copying certificate authorities
and service account keys on each node and <span class=k>then</span> running the following as root:

  kubeadm join 192.168.3.13:6443 --token qxu02l.g995k2yhkxjh3k80 <span class=se>\
</span><span class=se></span>        --discovery-token-ca-cert-hash sha256:b9887f55b739bd89d3b0dbb038e693df9b5b7d9759902ffb2a250288ba1ffc25 <span class=se>\
</span><span class=se></span>        --control-plane 

Then you can join any number of worker nodes by running the following on each as root:

kubeadm join 192.168.3.13:6443 --token qxu02l.g995k2yhkxjh3k80 <span class=se>\
</span><span class=se></span>        --discovery-token-ca-cert-hash sha256:b9887f55b739bd89d3b0dbb038e693df9b5b7d9759902ffb2a250288ba1ffc25 
</code></pre></div><p>Token 的有效时间为 24 小时，如果超时，使用以下命令重新获取：</p><pre><code>$ kubeadm token create --print-join-command
</code></pre><h2 id=9相关问题>9相关问题</h2><p>无法访问api端点如下</p><p><img src=https://gitee.com/fengzhenbing/picgo/raw/master/image-20210725233415235.png alt=image-20210725233415235></p><p>对于实验测试非线上来讲，可以直接将<code>system:anonymous</code>加为用户</p><pre><code>kubectl create clusterrolebinding test:anonymous --clusterrole=cluster-admin --user=system:anonymous
</code></pre><p>对于正式环境，需要创建一个用户并授权</p><h2 id=heading></h2></section><footer class=article-footer><section class=article-tags><a href=/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/>微服务</a>
<a href=/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/>云原生</a>
<a href=/tags/k8s/>K8S</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-contents--wrapper><h2 class=section-title>相关文章</h2><div class=related-contents><div class="flex article-list--tile"><article><a href=/p/envoy/><div class=article-details><h2 class=article-title>Envoy</h2></div></a></article><article><a href=/p/k8s-kubectl%E5%91%BD%E4%BB%A4/><div class=article-details><h2 class=article-title>k8s Kubectl命令</h2></div></a></article><article><a href=/p/%E6%9C%8D%E5%8A%A1%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/><div class=article-details><h2 class=article-title>服务链路追踪</h2></div></a></article><article><a href=/p/%E6%9E%B6%E6%9E%84%E6%BC%94%E5%8F%98/><div class=article-details><h2 class=article-title>架构演变</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=fengzhenbing/fengzhenbing.github.io issue-term=pathname label=Comment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(b){let a=document.querySelector('.utterances iframe');a&&a.contentWindow.postMessage({type:'set-theme',theme:`github-${b}`},'https://utteranc.es')}addEventListener('message',a=>{if(a.origin!=='https://utteranc.es')return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener('onColorSchemeChange',a=>{setUtterancesTheme(a.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 Feng Zhenbing's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.1.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section><span id=busuanzi_container_site_pv>本站访问量：<span id=busuanzi_value_site_pv></span>次</span>
&nbsp;
<span id=busuanzi_container_site_uv>您是本站第 <span id=busuanzi_value_site_uv></span>位访问者</span></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1环境准备>1.环境准备</a></li><li><a href=#2-安装-kubeletkubectlkubeadm>2. 安装 <strong>kubelet</strong>、<strong>kubectl</strong>、<strong>kubeadm</strong></a><ol><li><a href=#21关闭swap-分区>2.1关闭Swap 分区</a></li></ol></li><li><a href=#3-预拉取镜像>3 预拉取镜像</a><ol><li><a href=#31-配置阿里云加速地址>3.1 配置阿里云加速地址</a></li><li><a href=#32-拉取镜像修改tag>3.2 拉取镜像，修改tag</a></li></ol></li><li><a href=#4-初始化集群控制平面>4 初始化集群控制平面</a></li><li><a href=#5-为当前用户生成-kubeconfig>5 为当前用户生成 <strong>kubeconfig</strong></a></li><li><a href=#6-cni插件>6 CNI插件</a><ol><li><a href=#安装flannel-插件>安装Flannel 插件</a></li></ol></li><li><a href=#7-kubectl-命令自动补全功能>7 <strong>kubectl</strong> 命令自动补全功能</a></li><li><a href=#8-加入其他-node-节点到-kubernetes-集群中>8 加入其他 <strong>Node</strong> 节点到 <strong>Kubernetes</strong> 集群中</a></li><li><a href=#9相关问题>9相关问题</a></li><li><a href=#heading></a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script></body></html>